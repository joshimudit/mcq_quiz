<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quick MCQ Quiz</title>
  <style>
    :root {
      --bg: #0b0d10; /* near-black */
      --card: #11151a; /* dark slate */
      --ink: #e7edf3; /* soft white */
      --muted: #9fb3c8; /* desaturated blue-gray */
      --accent: #7dd3fc; /* sky */
      --accent-2: #86efac; /* green */
      --warn: #fca5a5; /* red-rose */
      --ring: #1f2937;
      --radius: 18px;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1200px 1200px at 80% -10%, #0f172a 0%, var(--bg) 60%);
      color: var(--ink);
      display: grid;
      place-items: center;
      padding: 24px;
    }

    .shell {
      width: min(860px, 100%);
    }

    .card {
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: var(--radius);
      box-shadow: 0 10px 40px rgba(0,0,0,0.4);
      backdrop-filter: blur(4px);
      padding: 22px;
    }

    header {
      display: flex; align-items: center; justify-content: space-between;
      gap: 16px; margin-bottom: 14px;
    }
    .title { font-size: clamp(18px, 2.4vw, 24px); font-weight: 700; letter-spacing: .2px; }
    .muted { color: var(--muted); font-size: 14px; }

    .progress {
      width: 100%; height: 8px; border-radius: 999px;
      background: #0f172a; overflow: hidden; border: 1px solid #111827;
    }
    .progress > div { height: 100%; width: 0; background: linear-gradient(90deg, var(--accent), var(--accent-2)); }

    .q {
      margin-top: 16px; margin-bottom: 10px; font-size: clamp(18px, 2.6vw, 22px);
      line-height: 1.4; font-weight: 600;
    }

    .opts { display: grid; gap: 10px; margin-top: 12px; }
    .btn {
      width: 100%; text-align: left; padding: 14px 16px; border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.08); background: #0b1220; color: var(--ink);
      cursor: pointer; font-size: 16px; transition: transform .06s ease, background .2s ease, border-color .2s ease;
    }
    .btn:hover { transform: translateY(-1px); border-color: rgba(125,211,252,0.4); }
    .btn[disabled] { opacity: .7; cursor: not-allowed; }

    .pill {
      display: inline-flex; align-items: center; gap: 8px; padding: 8px 12px; border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.12); background:#0b1220; font-size: 12px; color: var(--muted);
    }

    .feedback { margin-top: 12px; font-size: 15px; }
    .ok { color: var(--accent-2); }
    .bad { color: var(--warn); }

    .row { display:flex; gap:10px; flex-wrap: wrap; align-items: center; }
    .spacer { height: 12px; }

    .foot { display:flex; justify-content: space-between; align-items:center; margin-top: 18px; }
    .ghost {
      background: transparent; border: 1px dashed rgba(255,255,255,0.15); color: var(--muted);
      border-radius: 12px; padding: 10px 14px; cursor: pointer; font-size: 14px;
    }
    .primary { background: linear-gradient(180deg, #0ea5e9, #22d3ee); color: #05202b; border: none; font-weight: 700; }

    .endcard { text-align: center; padding: 28px 18px; }
    .score {
      font-size: 42px; font-weight: 800; letter-spacing: 1px; margin: 10px 0 4px;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      -webkit-background-clip: text; background-clip: text; color: transparent;
    }
    .cta { margin-top: 14px; }

    /* mobile-safe spacing for bottom buttons */
    @media (max-width:520px){ .btn { padding: 12px 12px; } }
  </style>
</head>
<body>
  <div class="shell">
    <div class="card" id="card">
      <header>
        <div class="title">Mock MCQ ‚Äî Quick Practice</div>
        <div class="row" style="margin-left:auto; gap:8px; align-items:center">
          <div class="pill"><span id="counter">Q 1/‚Äî</span></div>
          <button class="ghost" id="loadBtn" title="Load questions JSON">Load JSON</button>
          <input type="file" id="fileInput" accept="application/json" style="display:none" />
        </div>
      </header>

      <div class="progress" aria-label="progress"><div id="bar"></div></div>

      <div class="q" id="question">Loading‚Ä¶</div>
      <div class="muted" id="topic"></div>
      <div class="opts" id="options"></div>
      <div class="feedback" id="feedback"></div>

      <div class="foot">
        <button class="ghost" id="prevBtn" aria-label="Previous question">‚óÄ Prev</button>
        <div class="row">
          <button class="ghost" id="resetBtn" aria-label="Reset quiz">Reset</button>
          <button class="ghost" id="shuffleBtn" aria-label="Shuffle questions">Shuffle</button>
          <button class="primary" id="nextBtn" aria-label="Next question">Next ‚ñ∂</button>
        </div>
      </div>
    </div>

    <div class="card endcard" id="end" style="display:none">
      <div class="title">All done!</div>
      <div class="score" id="scoreLine">0 / 0</div>
      <div class="muted" id="remark">Nice work ‚ú®</div>
      <div class="cta">
        <button class="primary" id="againBtn">Try Again</button>
      </div>
    </div>

    <div class="muted" style="margin-top:10px; text-align:center; font-size:12px">Edit questions inside this file ‚Üí scroll to the <strong>Quiz Data</strong> block.</div>
  </div>

  <!-- QUIZ DATA: edit, add, or remove questions here. Keep ids unique. -->
  <script id="quiz-data" type="application/json">
  { "meta": { "title": "MCQ Quiz" }, "questions": [] }
  </script>

  <script>
    // Personalisation
    const NAME = 'Shruti';

    // Cute minimal aesthetic tweaks
    document.addEventListener('DOMContentLoaded', () => {
      document.title = 'Quiz for ' + NAME + ' ‚ú®';
    });

    // Encouragement pools
    const PRAISES = [
      `Lovely, ${NAME}! You nailed it ‚ú®`,
      `Boom, ${NAME}! Correct and classy.`,
      `Yes, ${NAME}! Brain = fire today üî•`,
      `Queen move, ${NAME}!`,
      `Sharp as ever, ${NAME} ‚úÖ`,
      `Chef‚Äôs kiss, ${NAME} üí´`,
      `Exactly right, ${NAME}!`,
      `That‚Äôs the spirit, ${NAME}!`,
      `Perfect pick, ${NAME} üíö`,
      `On a roll, ${NAME}!`,
      `Textbook answer, ${NAME}.`,
      `You‚Äôre cruising, ${NAME} üöÄ`,
      `Pro level, ${NAME}!`,
      `That‚Äôs how it‚Äôs done, ${NAME}.`,
      `Genius alert, ${NAME} ‚ú®`,
      `Green tick for the win, ${NAME}!`,
      `Immaculate choice, ${NAME}.`,
      `Love the accuracy, ${NAME}!`,
      `So good, ${NAME}!`,
      `Flawless, ${NAME}!`
    ];

    const ENCOURAGE = [
      `Close one, ${NAME}. You‚Äôve got this üí™`,
      `No stress, ${NAME} ‚Äî onwards we go.`,
      `Learning in motion, ${NAME}. Next one!`,
      `Almost there, ${NAME}. Keep the rhythm.`,
      `You‚Äôre improving with every click, ${NAME}.`,
      `Shake it off, ${NAME}. Fresh start on the next.`,
      `Good try, ${NAME}! Let‚Äôs lock the next one.`,
      `We move, ${NAME}. Progress > perfection.`,
      `It‚Äôs a stepping stone, ${NAME}.`,
      `All good, ${NAME}. You‚Äôre building mastery.`,
      `Right idea, wrong option ‚Äî happens, ${NAME}.`,
      `Every miss is data, ${NAME}.`,
      `Chin up, ${NAME}. The next one‚Äôs yours.`,
      `Reset and rock, ${NAME}!`,
      `You‚Äôre still on track, ${NAME}.`,
      `Heads up, ${NAME}. You‚Äôre learning fast.`,
      `We‚Äôre warming up, ${NAME}.`,
      `Nice attempt, ${NAME}. Keep going.`,
      `Solid effort, ${NAME}!`,
      `Not this one ‚Äî but you‚Äôll get the next, ${NAME}.`
    ];

    function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    // Utility: read JSON from the embedded (empty) script tag
    function loadQuizFromScript() {
      const el = document.getElementById('quiz-data');
      try { return JSON.parse(el.textContent.trim()); }
      catch (e) { console.error('Quiz JSON parse error', e); return { meta:{title:'Quiz'}, questions: []}; }
    }

    // Try to load external JSON from ?src=... or from file picker
    async function loadExternalIfAny(){
      const params = new URLSearchParams(location.search);
      const src = params.get('src');
      if (!src) return null;
      try {
        const res = await fetch(src, { cache: 'no-store' });
        if (!res.ok) throw new Error('HTTP '+res.status);
        const data = await res.json();
        if (!Array.isArray(data.questions)) throw new Error('questions not array');
        return data;
      } catch (e) {
        console.warn('Failed to load external quiz from', src, e);
        return null;
      }
    }

    // State
    let QUIZ = { meta:{ title:'MCQ Quiz' }, questions: [] };
    let idx = 0;
    let selected = new Map(); // id -> {choice, correct}

    // DOM refs
    const counter = document.getElementById('counter');
    const bar = document.getElementById('bar');
    const qEl = document.getElementById('question');
    const topicEl = document.getElementById('topic');
    const optsEl = document.getElementById('options');
    const feedbackEl = document.getElementById('feedback');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const resetBtn = document.getElementById('resetBtn');
    const shuffleBtn = document.getElementById('shuffleBtn');
    const loadBtn = document.getElementById('loadBtn');
    const fileInput = document.getElementById('fileInput');

    const end = document.getElementById('end');
    const card = document.getElementById('card');
    const scoreLine = document.getElementById('scoreLine');
    const remark = document.getElementById('remark');
    const againBtn = document.getElementById('againBtn');

    function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

    function render() {
      const q = QUIZ.questions[idx];
      const total = QUIZ.questions.length;
      document.title = (QUIZ.meta?.title || 'MCQ Quiz') + ' ‚Äî for ' + NAME;
      counter.textContent = `Q ${idx+1}/${total}`;
      bar.style.width = `${((idx) / total) * 100}%`;
      qEl.textContent = q.text || q.question || '‚Äî';
      topicEl.textContent = QUIZ.meta?.topic || '';
      feedbackEl.textContent = '';

      optsEl.innerHTML = '';
      const choices = q.choices || q.options; // allow either key
      choices.forEach((choice, i) => {
        const btn = document.createElement('button');
        btn.className = 'btn';
        btn.textContent = choice;
        btn.addEventListener('click', () => selectAnswer(i));
        optsEl.appendChild(btn);
      });

      const prev = selected.get(q.id || q.qid || idx);
      if (prev) { reveal(prev.choice); }

      prevBtn.disabled = idx === 0;
      nextBtn.textContent = idx === total - 1 ? 'Finish ‚ñ∂' : 'Next ‚ñ∂';
    }

    function selectAnswer(i) {
      const q = QUIZ.questions[idx];
      const answerIndex = (typeof q.answer === 'number') ? q.answer : q.correctIndex;
      const isCorrect = i === answerIndex;
      selected.set(q.id || q.qid || idx, { choice: i, correct: isCorrect });
      reveal(i);
    }

    function reveal(i){
      const q = QUIZ.questions[idx];
      const buttons = [...optsEl.querySelectorAll('.btn')];
      buttons.forEach(b => { b.disabled = true; b.style.borderColor = 'rgba(255,255,255,0.12)'; b.style.background = '#0b1220'; });

      const answerIndex = (typeof q.answer === 'number') ? q.answer : q.correctIndex;
      const picked = buttons[i];
      if (picked) picked.style.borderColor = (i === answerIndex) ? 'rgba(134, 239, 172, 0.7)' : 'rgba(252, 165, 165, 0.7)';

      const correctBtn = buttons[answerIndex];
      if (correctBtn) { correctBtn.style.background = 'linear-gradient(180deg, #064e3b, #052e2b)'; correctBtn.style.borderColor = 'rgba(134, 239, 172, 0.8)'; }

      const choices = q.choices || q.options;
      const base = (i === answerIndex)
        ? `<span class="ok">‚úÖ Correct!</span> <span class="muted">${pick(PRAISES)}</span>`
        : `<span class="bad">‚ùå Incorrect.</span> Correct: <strong>${choices[answerIndex]}</strong><br><span class="muted">${q.explain || q.explanation || ''}</span><br><span class="muted">${pick(ENCOURAGE)}</span>`;
      feedbackEl.innerHTML = base;
    }

    function next(){ if (idx < QUIZ.questions.length - 1) { idx++; render(); } else { finish(); } }
    function prev(){ idx = clamp(idx-1, 0, QUIZ.questions.length-1); render(); }

    function finish(){
      bar.style.width = '100%';
      const total = QUIZ.questions.length;
      let correct = 0; for (const q of QUIZ.questions){ if (selected.get(q.id || q.qid || q)?.correct) correct++; }
      scoreLine.textContent = `${correct} / ${total}`;
      const pct = (correct/total)*100;
      remark.textContent = pct >= 80 ? `Superb, ${NAME}! You‚Äôre exam-ready.`
        : pct >= 60 ? `Nice progress, ${NAME}. One more pass and you‚Äôre set.`
        : `Good hustle, ${NAME}. A quick revision and try again.`;
      card.style.display = 'none';
      end.style.display = 'block';
    }

    function reset(all=true){ if (all){ selected.clear(); idx = 0; } card.style.display = 'block'; end.style.display = 'none'; render(); }

    function shuffle(){
      for (let i = QUIZ.questions.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [QUIZ.questions[i], QUIZ.questions[j]] = [QUIZ.questions[j], QUIZ.questions[i]]; }
      selected.clear(); idx = 0; render();
    }

    // Bind
    nextBtn.addEventListener('click', next);
    prevBtn.addEventListener('click', prev);
    resetBtn.addEventListener('click', () => reset(true));
    shuffleBtn.addEventListener('click', shuffle);
    againBtn.addEventListener('click', () => reset(true));

    loadBtn.addEventListener('click', () => fileInput.click());
    fileInput.addEventListener('change', (ev) => {
      const f = ev.target.files?.[0]; if (!f) return;
      const reader = new FileReader();
      reader.onload = () => {
        try {
          const json = JSON.parse(String(reader.result));
          if (!Array.isArray(json.questions)) throw new Error('Expected {questions: [...]}');
          QUIZ = json; selected.clear(); idx = 0; reset(true);
        } catch (e){ alert('Invalid JSON file. Expected { meta, questions: [...] }'); console.error(e); }
      };
      reader.readAsText(f);
    });

    // Boot: prefer external, fall back to empty embedded (forces user to load JSON)
    (async function boot(){
      try {
        const ext = await loadExternalIfAny();
        if (ext) { QUIZ = ext; render(); return; }
        const embedded = loadQuizFromScript();
        if (Array.isArray(embedded.questions) && embedded.questions.length > 0) { QUIZ = embedded; render(); return; }
        const hint = 'No questions loaded. Use the "Load JSON" button or append ?src=yourfile.json to the URL.';
        qEl.textContent = hint;
        nextBtn.disabled = true; prevBtn.disabled = true; shuffleBtn.disabled = true; resetBtn.disabled = false;
      } catch (e) {
        qEl.textContent = 'Error loading questions. Open console for details (F12) or use Load JSON.';
        console.error('Boot error:', e);
      }
    })();
  </script>
</body>
</html>
